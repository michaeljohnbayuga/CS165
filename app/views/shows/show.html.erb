<%= render :file=> 'app/views/partials/header.html.erb' %>

<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

<style type="text/css">
.checked {
    color: gold;
}
#grad1 {
    color:white;
    height: 48px;
    width: 60px;
    padding:1px;
    border: 10px solid #FF8C00;
    text-align: center;
    background: #FF8C00; /* For browsers that do not support gradients */
}
 h1,#grad1{display:inline;}
div.stars {
  width: 250px;
  float: top;
  display: inline-block;
}

input.star { display: none; }

label.star {
  float: right;
  padding: 3px;
  font-size: 20px;
  color: #444;
  transition: all .2s;
}

input.star:checked ~ label.star:before {
  content: '\f005';
  color: #FD4;
  transition: all .25s;
}

input.star-5:checked ~ label.star:before {
  color: #FE7;
  text-shadow: 0 0 20px #952;
}

input.star-1:checked ~ label.star:before { color: #F62; }

label.star:hover { transform: rotate(-15deg) scale(1.3); }

label.star:before {
  content: '\f006';
  font-family: FontAwesome;
}

</style>


<div class="ui container">
  <h1><%= @show.name %><br>
 Community Average Rating: <div id="grad1"> <%= @ave_rating  %></div></h1><br><br>


  <% if current_user.present? && current_user.is_admin? %>
    <%= link_to "<i class='edit large icon'></i> Edit".html_safe, {action: "edit", id: @show.id}, style: 'color:#fff;', class: 'ui compact light blue button float-right' %>
    <!-- Checks if the user has already favorited the show then displays the appropriate link  -->
    <%- unless current_user.favorite_shows.exists?(id: @show.id) -%>
      <%= link_to 'Add to favorites', favorite_shows_path(show_id: @show), method: :post, style:'color:#fff;',class:'ui compact blue button float-right'%>
      <%- else -%>
      <%= link_to 'Remove from favorites', favorite_show_path(@show), method: :delete, style:'color:#fff;',class:'ui compact blue button float-right'%>
      <%- end -%>
  
  <% end %>
  
  <% if @show.attachment.present? %>
  	<img src="<%= @show.attachment %>" class="ui large image" id="show_logo" style="width:500px; height:500px;object-fit: contain; border: 7px solid #BBDEFB; background-color:#4f5563 ">
  <% else %>
    <img src="/logos/SAMPLE.jpg" class="ui large image" id="show_logo" style="width:500px; height:500px;object-fit: contain; border: 7px solid #BBDEFB; background-color:#4f5563 ">
  <% end %>
  
   
	<% if current_user.present? %> 
	
	<h3>Your Rating: <%= @user_rating %>  &emsp; </h3>	
	
  <script type="text/javascript">$(document).ready(function(){$(".rating").rating({initialRating: <%=@user_rating%>,maxrating:5});});</script>
	<div class=" massive ui star rating">
  <%= link_to "<i class=''></i>".html_safe, {controller: "ratings", action: "rate1", id: @show.id}, method: :POST, class: "star star-1 icon" %>
  <%= link_to "<i class=''></i>".html_safe, {controller: "ratings", action: "rate2", id: @show.id}, method: :POST, class: "star star-2 icon" %>
  <%= link_to "<i class=''></i>".html_safe, {controller: "ratings", action: "rate3", id: @show.id}, method: :POST, class: "star star-3 icon" %>
  <%= link_to "<i class=''></i>".html_safe, {controller: "ratings", action: "rate4", id: @show.id}, method: :POST, class: "star star-4 icon" %>
  <%= link_to "<i class=''></i>".html_safe, {controller: "ratings", action: "rate5", id: @show.id}, method: :POST, class: "star star-5 icon" 
  %>
	
	</div>	

	<% end %>

  <% if @show.network.present? %>
    <br><br><b>TV Network:</b> <%= @show.network %>
  <% end %>
  
  <br><br><b>Casts:</b> <%= @show.casts %>
  
  <br><br><b>Director:</b> <%= @show.director %>
  
  <br><br><b>Synopsis:</b> <%= @show.synopsis %>
  
  <br><br><b>Runtime per episode:</b> <%= @show.runtime %>
  
  <br><br><b>Language:</b> <%= @show.language %>

  <% if @show.start_year.present? %>
    <br><br><b>Years aired: </b><%= @show.start_year %>

    <% if @show.end_year.present? && (@show.start_year != @show.end_year) %>
    - <%= @show.end_year %>
    <% end %>

  
  <% end %>

  <br><br><b>Season count: </b><%= @seasons.count %>
  <% if @seasons.count == 1 %>
        Season
  <% else %>
        Seasons
  <% end %>

  <br><br><br><br><br><br><br>

  <% if @seasons.count > 0 %>
    <div class="ui three stackable special cards">
      <% @seasons.each do |season| %>
        <div class="card blurring dimmable">
          <div class="content">
            <div class="header float-right">SEASON <%= season.season_no %></div>
          </div>

          <div class="content">
            <div class="meta"><strong>
              <%= season.episodes.count %>
              <% if season.episodes.count == 1 %>
                    EPISODE
              <% else %>
                    EPISODES
              <% end %>
            </strong></div>

            <% if !season.start_date.nil? %>
              <strong>PREMIERE DATE: </strong><%= season.try(:start_date).try(:strftime, ("%b %d, %Y")) %>
            <% end %><br>

            <% if !season.end_date.nil? %>
              <strong>FINALE DATE: </strong><%= season.try(:end_date).try(:strftime, ("%b %d, %Y")) %>
            <% end %><br>
          </div>

          <div class="ui dimmer">
            <div class="content">
              <div class="center">
                <%= link_to "<i class='eye large icon'></i> View".html_safe, {controller: "seasons", action: "show", id: season.id}, style: 'color:#fff;', class: 'ui inverted button' %>
                <% if current_user.present? && current_user.is_admin? %>
                  &emsp;&emsp;&emsp;
                  <%= link_to "<i class='edit large icon'></i> Edit".html_safe, {controller: "seasons", action: "edit", id: season.id}, style: 'color:#fff;', class: 'ui inverted button' %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
      <!-- Checks if the user has already favorited the show then displays the appropriate link  -->
    <%- unless current_user.favorite_shows.exists?(id: @show.id) -%>
      <%= link_to 'Add to favorites', favorite_shows_path(show_id: @show), method: :post %>
      <%- else -%>
      <%= link_to 'Remove from favorites', favorite_show_path(@show), method: :delete %>
      <%- end -%>
    </div>
  <% end %>

  <%= link_to "<i class='edit large icon'></i> View Reviews".html_safe, {controller: "reviews", action: "create", id: @show.id}, style: 'color:#fff;', class: 'ui compact blue button' %>
</div>
